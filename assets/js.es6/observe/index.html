<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
    <title>Observer</title>
    <script src="observer.js"></script>
</head>

<body>
    <button>点击触发page任务</button>
    <button>点击取消page任务</button>
    <script type="text/javascript">
    //观察者
    var observer = new Observer();
    var observer2 = new Observer();

    //page函数
    //模拟运行1秒的一个函数
    function page() {
        setTimeout(function() {
            //发布一个完成的时间
            observer.publish("compelte")
            observer2.publish("remind")
        }, 3000)
    }

    //订阅一个完成的时间
    observer.subscribe("compelte", function() {
        alert("page任务完成")
    })
    observer2.subscribe("remind",function(){
        console.log();
    })

    //触发任务
    document.querySelectorAll("button")[0].addEventListener("click", function() {
        page();
    }, false)

    //取消任务
    document.querySelectorAll("button")[1].addEventListener("click", function() {
        observer.unsubscribe("compelte")
        alert("注销了订阅了compelte事件")
    }, false)
    </script>
</body>
